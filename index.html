<!DOCTYPE html>
<html>
  <head>
    <title>Your Mix</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
		.group {
			float: left;
			width: 18%;
			height: 800px;
			align-items: center;
			padding-top: 40px;
		}
		.group img {
			padding-bottom: 50px;
		}
		.comanda {
			position: relative;
			width: 28%;
			height: 800px;
			float: right;
			padding-top: 29px;
			background-color: #f2f2f2;
		}
		.center {
			display: block;
			margin-left: auto;
			margin-right: auto;
		}
		input {
			display: block;
			margin-left: auto;
			margin-right: auto;
			padding-top: 10px;
		}
		.filling-cup {
			display: flex;
			align-items: center;
			justify-content: center;
		}
		.bottom {
			display: flex;
			align-items: center;
			justify-content: center;
			flex-direction: column;

			position: absolute;
			bottom: 0px;
			margin-left: auto;
			margin-right: auto;
			left: 0px;
  			right: 0px;

			background-image: url('arch.png');
			background-size: cover;
			padding-top: 30px;
		}
		.list {
			text-align: justify;
			text-justify: inter-word;
		}
	</style>
  </head>
  <body>
	<div>
		<div class="group" style="background-color: #ffefae;">
			<img src="fructe.png" class="center">

			<input id="Portocale" type="image"/>
			<input id="Mar" type="image" />
			<input id="Banane" type="image" />
			<input id="Lamaie" type="image" />
			<input id="Lime" type="image" />
			<input id="Kiwi" type="image" />
			<input id="Ananas" type="image" />
			<input id="Cocos" type="image" />
			<input id="Grapefruit" type="image" />
		</div>
		<div class="group" style="background-color: #ffdac1;">
			<img src="legume.png" class="center">
			<input id="Patrunjel" type="image" />
		</div>
		<div class="group" style="background-color: #e9f5d8;">
			<img src="verdeturi.png" class="center">
		</div>
		<div class="group" style="background-color: #e1f5fc;">
			<img src="specials.png" class="center">
		</div>
	</div>
	<div>

  <div class="comanda">
	<img src="moodfresh.png" class="center" style="padding-bottom: 50px;">
	<div  class="filling-cup">
		<canvas id="canvas" width="120" height="216" style="position:absolute;">
			Pahar
		</canvas>
		<img src="pahar.png" style="position:relative;">
	</div>

	<div class="filling-cup">
			<p class="list">
				<b><font id="grams" size="+1" color="#878fa3"><b>0 ml</font></b>
			</p>
	</div>

	<div class="bottom">
		<img src="pret.png">
		<p>
			<b><font id="total" size="+1" color="#878fa3">0 RON</font></b>
		</p>
		<div style="display: inline; width: 90%;">
			<input id="x" src="elimina.png" onclick="remove_fruit();" type="image" style="float:left;"/>
			<img id="cmd" src="comanda_gray.png" onclick="toggleImage();" style="float:right;"/>
		</div>
	</div>
</div>
</div>
<script>
		const idx_img = 0;
		const idx_fill = 1;
		const idx_amount = 2;
		const idx_mony = 3;
		const idx_func_add = 4;

		// img, fill, amount, price
		var Portocale = ["Portocale.png", 'green', 100, 3, () => add_fruit_param('Portocale') ];
		var Mar = ["Mar.png", 'green', 100, 3, () => add_fruit_param('Mar') ];
		var Banane = ["Banane.png", 'orange', 100, 3, () => add_fruit_param('Banane') ];
		var Lamaie = ["Lamaie.png", 'orange', 100, 3, () => add_fruit_param('Lamaie') ];
		var Lime = ["Lime.png", 'orange', 100, 3, () => add_fruit_param('Lime') ];
		var Kiwi = ["Kiwi.png", 'orange', 100, 3, () => add_fruit_param('Kiwi') ];
		var Ananas = ["Ananas.png", 'orange', 100, 3, () => add_fruit_param('Ananas') ];
		var Cocos = ["Cocos.png", 'orange', 100, 3, () => add_fruit_param('Cocos') ];
		var Grapefruit = ["Grapefruit.png", '#e65f47', 100, 3, () => add_fruit_param('Grapefruit') ];

		var Patrunjel = ["Patrunjel.png", 'green', 20, 2, () => add_fruit_param('Patrunjel') ];

		var canvas = document.getElementById('canvas');
		var canvas_h = canvas.height;
		var ctx = canvas.getContext('2d');
		var level = 0;
		var total = 0;
		var Mic = 450;
		var Mare = 500; // grams
		var ppgr = 300 / 500; // pixels per gram
		var ingredients = [];

		function show_total(name) {
			var tot_sum = document.getElementById('total');
			tot_sum.innerHTML = total + ' RON';

			var tot_sum = document.getElementById('grams');
			tot_sum.innerHTML = '';
			for (let i = 0; i < ingredients.length; i += 3) {
				tot_sum.innerHTML += ingredients[i] + ' ' + ingredients[i+1] + ' ml.' + "<br />";
			}
			tot_sum.innerHTML += "-------<br />";
			tot_sum.innerHTML += total + ' ml.';
		}

		function add_fruit(name, fill, gr, price) {
			if ( level < Mare - gr ) {
				ctx.fillStyle = fill;
				ctx.fillRect(10, canvas_h - (level+gr)*ppgr, 100, gr*ppgr);
				level += gr;
				total += price;

				ingredients.push(name);
				ingredients.push(gr);
				ingredients.push(price);

				show_total(name);
			}
		}

		function remove_fruit() {
			if ( level > 0 ) {
				price = ingredients.pop();
				gr = ingredients.pop();
				name = ingredients.pop();
				level -= gr;
				ctx.clearRect(10, canvas_h - (level+gr)*ppgr, 100, gr*ppgr);
				total -= price;
				show_total(name);
			}
		}

		function make_button(fruit) {
			var button;
			button = document.getElementById(fruit);
			var f_arr = eval(fruit);
			button.src = f_arr[idx_img];
			button.onclick = f_arr[idx_func_add];
		}

		function add_fruit_param(fruit_name) {
			var fruit = eval(fruit_name);
			//add_fruit(Object.keys({fruit})[0], fruit[idx_fill], fruit[idx_amount], fruit[idx_mony]);
			add_fruit(fruit_name, fruit[idx_fill], fruit[idx_amount], fruit[idx_mony]);
		}

		function toggleImage() {
				var img1 = "comanda.png";
				var img2 = "comanda_gray.png";
					
				var img = document.getElementById('cmd').src;
				if (img.indexOf(img1) != -1) {
					document.getElementById('toggleImage').src = img2;
				} else {
					document.getElementById('toggleImage').src = img1;
				}
		}

		make_button("Portocale");
		make_button("Mar");
		make_button("Banane");
		make_button("Lamaie");
		make_button("Lime");
		make_button("Kiwi");
		make_button("Ananas");
		make_button("Cocos");
		make_button("Grapefruit");

		make_button("Patrunjel");
    </script>
  </body>
</html>
